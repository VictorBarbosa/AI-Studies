{"version":3,"file":"src_app_main_style-transfer_style-transfer_component_ts.js","mappings":"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","sources":["./src/app/main/style-transfer/style-transfer.component.ts","./src/app/main/style-transfer/style-transfer.component.html"],"sourcesContent":["import { CommonModule } from '@angular/common';\n\nimport { IonicModule } from '@ionic/angular';\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\nimport * as tf from '@tensorflow/tfjs'\nimport { FormsModule } from '@angular/forms';\nimport { BehaviorSubject, distinctUntilChanged, shareReplay, tap } from 'rxjs';\nimport { downloadImage } from '../../common/common';\n\n\ninterface ImagesTransfer {\n  label: string,\n  img: string\n}\n@Component({\n  selector: 'app-style-transfer',\n  templateUrl: './style-transfer.component.html',\n  styleUrls: ['./style-transfer.component.scss'],\n  standalone: true,\n  imports: [IonicModule, CommonModule, FormsModule],\n})\nexport class StyleTransferComponent implements OnInit {\n\n  images: ImagesTransfer[] = [\n    { img: 'assets/Derkovits_Gyula_Taligás.jpeg', label: 'Derkovits_Gyula_Taligás' },\n    { img: 'assets/Landscape_with_black_figure.jpeg', label: 'Landscape_with_black_figure' },\n    { img: 'assets/Large_bonfire.jpg', label: 'Large_bonfire' },\n    { img: 'assets/Les_Demoiselles_d.jpeg', label: 'Les_Demoiselles_d.jpeg' },\n    { img: 'assets/Nantes_from_the_Ile_Feydeau.jpeg', label: 'Nantes_from_the_Ile_Feydeau' },\n    { img: 'assets/Pillars_of_creation.jpeg', label: 'Pillars_of_creation.jpeg' },\n    { img: 'assets/Still_Life_with_a_Bottle_of_Rum.jpg', label: 'Still_Life_with_a_Bottle_of_Rum' },\n    { img: 'assets/Still_life.jpeg', label: 'Still_life' },\n    { img: 'assets/The_Scream.jpeg', label: 'The_Scream' },\n    { img: 'assets/Van_Gogh.jpeg', label: 'Van_Gogh' },\n    { img: 'assets/Vassily_Kandinsky.jpeg', label: 'Vassily_Kandinsky' },\n    { img: 'assets/kanagawa_great_wave.jpeg', label: 'kanagawa_great_wave' }\n  ]\n\n  model: tf.GraphModel<string | tf.io.IOHandler> | null = null;\n\n  @ViewChild('cont') cont: ElementRef<HTMLImageElement> | null = null;\n  @ViewChild('style') style: ElementRef<HTMLImageElement> | null = null;\n  @ViewChild('canv') canv: ElementRef<HTMLCanvasElement> | null = null;\n  @ViewChild('filePic') filePic: ElementRef<HTMLInputElement> | null = null;\n  @ViewChild('fileStyle') fileStyle: ElementRef<HTMLInputElement> | null = null;\n\n\n\n  /*\n   * selected\n   */\n  private readonly _selected = new BehaviorSubject<string | null>('assets/Derkovits_Gyula_Taligás.jpeg');\n  selected$ = this._selected.asObservable().pipe(distinctUntilChanged(), shareReplay({ bufferSize: 1, refCount: true }));\n\n  /*\n  * selected getter\n  */\n  get selected(): string | null {\n    return this._selected.getValue();\n  }\n\n  /*\n   * selected setter\n   */\n  set selected(value: string | null) {\n    if (this._selected.getValue() !== value) {\n      this._selected.next(value);\n\n    }\n  }\n  constructor() {\n    tf.loadGraphModel('assets/StyleTranfer/model.json',).then(x => {\n      this.model = x;\n      this.apply()\n    })\n\n  }\n\n  ngOnInit(): void {\n\n    this._selected\n      .pipe(tap((value) => {\n        if ('fileUpload' === value) {\n          this.fileStyle?.nativeElement.click();\n        }\n      }))\n      .subscribe()\n  }\n\n  apply() {\n    if (this.model && this.cont?.nativeElement && this.style?.nativeElement) {\n      const img1 = tf.browser.fromPixels(this.cont.nativeElement, 3).resizeNearestNeighbor([224, 224])\n        .expandDims().div(255.0).toFloat();\n      const img2 = tf.browser.fromPixels(this.style.nativeElement, 3).resizeNearestNeighbor([224, 224])\n        .expandDims().div(255.0).toFloat();\n      const ret = (this.model.execute([img1, img2]) as any).dataSync() as Float32Array;\n      const t4d = tf.tensor3d(Array.from(ret), [224, 224, 3])\n      tf.browser.toPixels(t4d, this.canv?.nativeElement)\n    }\n  }\n\n\n  /**\n   * File upload\n   */\n  fileUploadPicture(ev: any) {\n    const file = ev.target.files[0];\n    const reader = new FileReader();\n    reader.onloadend = (e: any) => {\n      let image = new Image();\n      image.src = e.target.result;\n      if (this.cont?.nativeElement) {\n        this.cont.nativeElement.src = image.src;\n      }\n    }\n    reader.readAsDataURL(file);\n  }\n\n  /**\n   * clickFileUpload\n   */\n  clickFileUploadPicute() {\n    this.filePic?.nativeElement.click();\n  }\n\n  /**\n * File upload\n */\n  fileUploadStyle(ev: any) {\n    const file = ev.target.files[0];\n    const reader = new FileReader();\n    reader.onloadend = (e: any) => {\n      let image = new Image();\n      image.src = e.target.result;\n      if (this.style?.nativeElement) {\n        this.style.nativeElement.src = image.src;\n      }\n    }\n    reader.readAsDataURL(file);\n  }\n\n  /**\n   * clickFileUpload\n   */\n  clickFileUploadStyle() {\n    this.fileStyle?.nativeElement.click();\n  }\n\n  ngOnDestroy(): void {\n    this.model?.dispose()\n  }\n\n  downloadPicture() {\n    if (this.canv?.nativeElement) {\n      downloadImage(this.canv.nativeElement)\n    }\n  }\n}\n","<div class=\"container\">\n  <div class=\"image-container\">\n    <div class=\"image\">\n      <img #cont width=\"224\" src=\"assets/cont.jpeg\" alt=\"\">\n      <input hidden accept=\".jpg,.jpeg\" type=\"file\" #filePic (change)=\"fileUploadPicture($event)\" />\n\n      <ion-button (click)=\"clickFileUploadPicute()\">Upload File </ion-button>\n    </div>\n    <div class=\"image\">\n      <img #style width=\"224\" [src]=\"selected\" alt=\"\">\n      <input hidden accept=\".jpg,.jpeg\" type=\"file\" #fileStyle (change)=\"fileUploadStyle($event)\" />\n      <select [(ngModel)]=\"selected\">\n        <option *ngFor=\"let img of images\" [value]=\"img.img\"> {{img.label}} </option>\n        <option value=\"fileUpload\"> Upload File </option>\n      </select>\n    </div>\n\n  </div>\n  <div class=\"container-result\">\n    <canvas #canv></canvas>\n    <div class=\"buttons-alignment\">\n      <ion-button (click)=\"apply()\">Apply</ion-button>\n      <ion-button (click)=\"downloadPicture()\">Download</ion-button>\n    </div>\n  </div>\n</div>\n"],"names":["CommonModule","IonicModule","tf","FormsModule","BehaviorSubject","distinctUntilChanged","shareReplay","tap","downloadImage","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","img_r6","img","ɵɵadvance","ɵɵtextInterpolate1","label","StyleTransferComponent","selected","_selected","getValue","value","next","constructor","images","model","cont","style","canv","filePic","fileStyle","selected$","asObservable","pipe","bufferSize","refCount","loadGraphModel","then","x","apply","ngOnInit","nativeElement","click","subscribe","img1","browser","fromPixels","resizeNearestNeighbor","expandDims","div","toFloat","img2","ret","execute","dataSync","t4d","tensor3d","Array","from","toPixels","fileUploadPicture","ev","file","target","files","reader","FileReader","onloadend","e","image","Image","src","result","readAsDataURL","clickFileUploadPicute","fileUploadStyle","clickFileUploadStyle","ngOnDestroy","dispose","downloadPicture","selectors","viewQuery","StyleTransferComponent_Query","rf","ctx","ɵɵelement","ɵɵlistener","StyleTransferComponent_Template_input_change_5_listener","$event","StyleTransferComponent_Template_ion_button_click_7_listener","StyleTransferComponent_Template_input_change_12_listener","StyleTransferComponent_Template_select_ngModelChange_14_listener","ɵɵtemplate","StyleTransferComponent_option_15_Template","StyleTransferComponent_Template_ion_button_click_22_listener","StyleTransferComponent_Template_ion_button_click_24_listener","ɵɵsanitizeUrl","i1","IonButton","i2","NgForOf","i3","NgSelectOption","ɵNgSelectMultipleOption","SelectControlValueAccessor","NgControlStatus","NgModel","styles"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}