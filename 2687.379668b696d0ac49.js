"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2687],{2687:(v,d,a)=>{a.r(d),a.d(d,{CustomClassificationModelComponent:()=>P});var r=a(89),c=a(8207),p=a(3905),f=a(6284),M=a(4121),C=a(2147),h=a(3291),i=a(4401),t=a(5095);function E(o,l){if(1&o&&t._UZ(0,"img",8),2&o){const n=l.$implicit;t.Akn(n.rotate),t.Q6J("src",n.img.src,t.LSH)}}let P=(()=>{class o{get images(){return this._images.getValue()}set images(n){this._images.getValue()!==n&&this._images.next(n)}constructor(){this._images=new M.X(null),this.images$=this._images.asObservable().pipe((0,C.x)(),(0,h.d)({bufferSize:1,refCount:!0}))}ngOnInit(){this._images.subscribe(n=>{n?.forEach(e=>{e.tensorImage=i.Xhn.fromPixels(e.img).resizeNearestNeighbor([224,224]).expandDims().div(255).toFloat()})})}imageLoad(n){const e=n,m=[];for(let s=0;s<e.length;s++){const u=e[s],g=document.createElement("img");g.width=224,g.height=224,g.src=URL.createObjectURL(u);let _=`transform:rotate(${2*s+90}deg)`;e.length-1===s&&(_="transform:rotate(0deg)"),m.push({fileName:u.name,img:g,index:s,rotate:_})}this._images.next(m)}trainModel(){const n=this.images?.map(e=>e?.tensorImage);if(void 0!==n){const e=i.Pel();e.add(i.ugM.dense({units:3,inputShape:[224,224,3]})),e.add(i.ugM.conv2d({filters:16,kernelSize:3,padding:"same",activation:"relu"})),e.add(i.ugM.maxPooling2d({})),e.add(i.ugM.conv2d({filters:32,kernelSize:3,padding:"same",activation:"relu"})),e.add(i.ugM.maxPooling2d({})),e.add(i.ugM.conv2d({filters:64,kernelSize:3,padding:"same",activation:"relu"})),e.add(i.ugM.maxPooling2d({})),e.add(i.ugM.dropout({rate:.2})),e.add(i.ugM.flatten({})),e.add(i.ugM.dense({units:128,activation:"softmax"})),e.add(i.ugM.dense({units:1})),e.compile({optimizer:"adam",loss:i.MB5.meanSquaredError,metrics:["accuracy"]}),e.summary(),e.fit(n,n,{epochs:5}).then(m=>{})}}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-custom-classification-model"]],standalone:!0,features:[t.jDz],decls:12,vars:5,consts:[["id","container"],[2,"display","flex","flex-direction","column","align-items","center"],["img",""],[1,"img-container"],[3,"style","src",4,"ngFor","ngForOf"],[1,"buttons","alingment"],[3,"multiple","srcImageChange"],[3,"click"],[3,"src"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"img",null,2),t.TgZ(4,"div",3),t.YNc(5,E,1,3,"img",4),t.qZA()(),t.TgZ(6,"div",5)(7,"app-image-uploder",6),t.NdJ("srcImageChange",function(s){return e.imageLoad(s)}),t.qZA(),t.TgZ(8,"ion-button",7),t.NdJ("click",function(){return e.trainModel()}),t._uU(9," Train"),t.qZA()()(),t._uU(10),t.ALo(11,"json")),2&n&&(t.xp6(5),t.Q6J("ngForOf",e.images),t.xp6(2),t.Q6J("multiple",!0),t.xp6(3),t.hij(" ",t.lcZ(11,3,e.images),"\n"))},dependencies:[c.Pc,c.YG,r.ez,r.sg,r.Ts,p.D,f.u5],styles:[".img-container[_ngcontent-%COMP%]{display:contents}.img-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:244px;position:absolute;height:244px}.alingment[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;align-content:stretch;justify-content:center;align-items:stretch}"]}),o})()}}]);