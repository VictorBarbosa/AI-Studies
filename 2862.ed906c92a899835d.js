"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2862],{2862:(T,C,s)=>{s.r(C),s.d(C,{CarPositionComponent:()=>A});var c=s(334),d=s(4121),u=s(2147),g=s(3291),v=s(7241),h=s(1947),e=s(5095);let x=(()=>{class n{get model(){return this._model.getValue()}set model(t){this._model.getValue()!==t&&this._model.next(t)}constructor(){this._model=new d.X(null),this.model$=this._model.asObservable().pipe((0,u.x)(),(0,g.d)({bufferSize:1,refCount:!0})),c.YLj("assets/car_position/model.json").then(t=>{this._model.next(t)})}predict(t,i=224,o=224){const r=this.model;return new v.y(a=>{let p=c.Xhn.fromPixels(t,3).resizeNearestNeighbor([i,o]).toFloat().div(c.iD$(255)).expandDims();r&&r.execute(p).data().then(f=>{var m=this.getPredictedClass(f);a.next(m)})})}predictBase64(t,i=224,o=224){return new v.y(r=>{const a=this.model,p=new Image(i,o);p.onload=()=>{let f=c.Xhn.fromPixels(p,3).resizeNearestNeighbor([i,o]).toFloat().div(c.iD$(255)).expandDims();a&&a.execute(f).data().then(m=>{c.XAC(m).dataSync();var F=this.getPredictedClass(m);r.next(F)})},p.src=t})}getPredictedClass(t){if(!t||0===t.length){const r=[];for(let a=0;a<5;a++)r.push({name:"-",probability:0,index:0});return r}const i=Array.prototype.slice.call(t);return(0,h.XA)(i),(0,h.ll)(i,5,h.RL)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var P=s(89),b=s(8207),y=s(8168);const I=["img"],Z=["file"];function U(n,l){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA()()),2&n){const t=l.$implicit;e.xp6(2),e.hij(" ",t.name,""),e.xp6(2),e.hij(" ",t.probability,"")}}let A=(()=>{class n{get srcImage(){return this._srcImage.getValue()}set srcImage(t){this._srcImage.getValue()!==t&&this._srcImage.next(t)}get position(){return this._position.getValue()}set position(t){this._position.getValue()!==t&&this._position.next(t)}constructor(t){this.carPosition=t,this.img=null,this.file=null,this._srcImage=new d.X(""),this.srcImage$=this._srcImage.asObservable().pipe((0,u.x)(),(0,g.d)({bufferSize:1,refCount:!0})),this._position=new d.X(null),this.position$=this._position.asObservable().pipe((0,u.x)(),(0,g.d)({bufferSize:1,refCount:!0}))}ngOnInit(){this._srcImage.pipe((0,y.b)(t=>{this.img?.nativeElement.setAttribute("src",t),this.carPosition.predictBase64(t).pipe((0,y.b)(i=>{this._position.next(i)})).subscribe()})).subscribe()}pictureUpload(t){const i=t.target.files[0],o=new FileReader;o.onloadend=r=>{(new Image).src=r.target.result,this._srcImage.next(r.target.result)},o.readAsDataURL(i)}clickFileUpload(){this.file?.nativeElement.click()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(x))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-car-position"]],viewQuery:function(t,i){if(1&t&&(e.Gf(I,7),e.Gf(Z,7)),2&t){let o;e.iGM(o=e.CRH())&&(i.img=o.first),e.iGM(o=e.CRH())&&(i.file=o.first)}},standalone:!0,features:[e._Bn([x]),e.jDz],decls:12,vars:1,consts:[["id","container"],[2,"display","flex","flex-direction","column","align-items","center"],["img",""],[4,"ngFor","ngForOf"],[1,"buttons"],["hidden","","accept",".jpg,.jpeg","type","file",3,"change"],["file",""],[3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"img",null,2),e.TgZ(4,"div")(5,"table"),e.YNc(6,U,5,2,"tr",3),e.qZA()()(),e.TgZ(7,"div",4)(8,"input",5,6),e.NdJ("change",function(r){return i.pictureUpload(r)}),e.qZA(),e.TgZ(10,"ion-button",7),e.NdJ("click",function(){return i.clickFileUpload()}),e._uU(11,"Upload Car Picture "),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("ngForOf",i.position))},dependencies:[b.Pc,b.YG,P.ez,P.sg],styles:["img[_ngcontent-%COMP%]{max-width:224px;max-height:224px}"]}),n})()}}]);